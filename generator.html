<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f9f9f9; }
    input, button { padding: 10px; margin: 5px 0; }
    .link-box { margin-top: 10px; background: #fff; padding: 10px; border: 1px solid #ccc; }
    .delete-btn { color: red; cursor: pointer; }
  </style>
</head>
<body>

<h2>Generate Product Page</h2>
<input id="productName" placeholder="Product Name"><br>
<input id="productPrice" placeholder="Product Price (INR)"><br>
<button onclick="createPage()">Generate</button>

<div id="linksContainer"></div>

<script>
  const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
  const linksContainer = document.getElementById("linksContainer");

  function createPage() {
    const name = document.getElementById("productName").value.trim();
    const price = document.getElementById("productPrice").value.trim();

    if (!name || !price) {
      alert("Please enter both fields");
      return;
    }

    const id = "page_" + Date.now() + "_" + Math.floor(Math.random() * 10000);
    const product = { id, name, price };

    gun.get("products").get(id).put(product, ack => {
      if (ack.err) {
        alert("Error saving product");
      } else {
        const link = `page.html?id=${id}`;
        const div = document.createElement("div");
        div.className = "link-box";
        div.innerHTML = `
          <a href="${link}" target="_blank">${name} - ₹${price}</a>
          <span class="delete-btn" onclick="deleteProduct('${id}', this)"> [Delete]</span>
        `;
        linksContainer.appendChild(div);
      }
    });
  }

  function deleteProduct(id, el) {
    gun.get("products").get(id).put(null);
    el.parentElement.remove();
  }

  // Load existing on page load
  gun.get("products").map().once((data, id) => {
    if (data && data.name) {
      const link = `page.html?id=${id}`;
      const div = document.createElement("div");
      div.className = "link-box";
      div.innerHTML = `
        <a href="${link}" target="_blank">${data.name} - ₹${data.price}</a>
        <span class="delete-btn" onclick="deleteProduct('${id}', this)"> [Delete]</span>
      `;
      linksContainer.appendChild(div);
    }
  });
</script>

</body>
</html>
