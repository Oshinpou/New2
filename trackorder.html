<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Track Order</title>
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #eef; }
    input { margin: 5px 0; padding: 6px; width: 100%; }
    button { margin-top: 10px; }
    .order { border: 1px solid #999; background: #fff; padding: 10px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Track Order</h2>
  <input id="trackId" placeholder="Enter Order ID" />
  <button onclick="trackOrder()">Search</button>
  <div id="trackResults"></div>

  <script>
    const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
    const adminPages = ['admin1-orders', 'admin2-orders']; // Add more later
    let found = false;

    function trackOrder() {
      const id = document.getElementById('trackId').value.trim();
      document.getElementById('trackResults').innerHTML = '';
      found = false;

      adminPages.forEach(pageKey => {
        gun.get(pageKey).get(id).once(data => {
          if (data && !found) {
            found = true;
            showOrder(data);
          }
        });
      });

      setTimeout(() => {
        if (!found) {
          document.getElementById('trackResults').innerHTML = 'Order not found.';
        }
      }, 1000);
    }

    function showOrder(order) {
      const div = document.createElement('div');
      div.className = 'order';
      div.innerHTML = `
        <strong>Order ID:</strong> ${order.id}<br>
        <strong>Status:</strong> ${order.status}<br>
        <strong>Category:</strong> ${order.category}<br>
        <strong>Subcategory:</strong> ${order.subcategory}<br>
        <strong>Total:</strong> ₹${order.total}<br>
        <strong>Items:</strong><ul>
          ${order.items.map(i => `<li>${i.name} - ${i.qty} x ₹${i.price} [${i.color}, ${i.size}]</li>`).join('')}
        </ul>
      `;
      document.getElementById('trackResults').appendChild(div);
    }
  </script>
</body>
</html>
